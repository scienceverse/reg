<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Power Demo (ANOVA) • scienceverse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Power Demo (ANOVA)">
<meta property="og:description" content="scienceverse">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-160147578-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-160147578-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scienceverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9018</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/scienceverse/scienceverse/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="power_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Power Demo (ANOVA)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/scienceverse/scienceverse/blob/master/vignettes/power.Rmd"><code>vignettes/power.Rmd</code></a></small>
      <div class="hidden name"><code>power.Rmd</code></div>

    </div>

    
    
<p>How do you test a specific hypothesis for a complex hypothesis, such as a 4x3x2 mixed-design ANOVA? For example, suppose you have a hypothesis about two within-subject factors (A and B) in three between-subject conditions (control, C1 and C2). You predict that there will be no effects of A or B (and no interaction) in the control condition, an effect of B only on A1 in the first experimental condition, and an effect of B only on A2 in the second experimental condition.</p>
<p>The point of this tutorial is to show just how complex the decision criteria can be for an interaction. I don’t think I’ve chosen ideal criteria, but this is a model for how to start thinking about how you’d specify hypothesis corroboration criteria that are more sophisticated than just “predict a significant 3-way interaction”.</p>
<div id="packages-used" class="section level2">
<h2 class="hasAnchor">
<a href="#packages-used" class="anchor"></a>Packages Used</h2>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/scienceverse/scienceverse">scienceverse</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/debruine/faux">faux</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://afex.singmann.science/">afex</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="../reference/scienceverse_options.html">scienceverse_options</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
</div>
<div id="test-data-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#test-data-simulation" class="anchor"></a>Test Data Simulation</h2>
<p>First, simulate some data so you can build your analysis structure. I’ve built in a pretty big interaction, with nothing at all going on in the control condition, and opposite interactions among the within-subject factors in experimental conditions 1 and 2. There are 20 observations (<code>n</code>) in each between cell. Check the</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">faux</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/faux/man/sim_design.html">sim_design</a></span><span class="op">(</span>
   within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>, <span class="st">"A4"</span><span class="op">)</span>,
                 B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span><span class="op">)</span>,
   between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C0"</span>, <span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span><span class="op">)</span>,
   n <span class="op">=</span> <span class="fl">20</span>,
        <span class="co"># A1_B1, A1_B2, A2_B1 ... A4_B2</span>
   mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="co"># C0</span>
          <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.2</span>,  <span class="fl">0</span>, <span class="fl">.4</span>,  <span class="fl">0</span>, <span class="fl">.6</span>,  <span class="fl">0</span>,  <span class="co"># C1</span>
          <span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">.2</span>,  <span class="fl">0</span>, <span class="fl">.4</span>,  <span class="fl">0</span>, <span class="fl">.6</span><span class="op">)</span>, <span class="co"># C2</span>
   sd <span class="op">=</span> <span class="fl">1</span>,
   r <span class="op">=</span> <span class="fl">0.5</span>,
   id <span class="op">=</span> <span class="st">"sub_id"</span>,
   dv <span class="op">=</span> <span class="st">"score"</span>,
   long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p><img src="power_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div id="test-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#test-analysis" class="anchor"></a>Test analysis</h2>
<p>I’m using the <code><a href="https://rdrr.io/pkg/afex/man/aov_car.html">afex::aov_ez()</a></code> function to run an ANOVA. This maps on pretty straightforwardly to the way you simulate the data in {faux}.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co"># run ANOVA</span>
<span class="va">omnibus</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"sub_id"</span>,
                        dv <span class="op">=</span> <span class="st">"score"</span>,
                        between <span class="op">=</span> <span class="st">"C"</span>,
                        within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,
                        data <span class="op">=</span> <span class="va">dat</span>,
                        return <span class="op">=</span> <span class="st">"afex_aov"</span><span class="op">)</span></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: C</code></pre>
<p>{scienceverse} requires any numbers you use from an analysis to be returned as a named list, and we only care about the 3-way interaction for this study, so we’ll use {broom} and {dplyr} to get just the values we want.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># get stats for 3-way interaction</span>
<span class="va">ixn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">omnibus</span><span class="op">)</span><span class="op">[</span><span class="st">"C:A:B"</span>, <span class="op">]</span>

<span class="co"># calculate group means</span>
<span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">A</span>, <span class="va">B</span>, <span class="va">C</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="st">"grp"</span>, <span class="va">A</span>, <span class="va">B</span>, <span class="va">C</span><span class="op">)</span>

<span class="va">m</span> <span class="op">&lt;-</span> <span class="va">means</span><span class="op">$</span><span class="va">m</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">means</span><span class="op">$</span><span class="va">grp</span>

<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  p <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span>,
  F <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="cn">F</span>,
  means <span class="op">=</span> <span class="va">m</span>
<span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<pre><code>## List of 3
##  $ p    : num 0.351
##  $ F    : num 1.12
##  $ means: Named num [1:24] 0.3397 0.5654 -0.0924 0.1731 0.6192 ...
##   ..- attr(*, "names")= chr [1:24] "A1_B1_C0" "A1_B1_C1" "A1_B1_C2" "A1_B2_C0" ...</code></pre>
<p>Now you might also want to do some analyses to check that the pattern of any significant 3-way interaction is consistent with your hypothesis.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">aov_control</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"sub_id"</span>,
                        dv <span class="op">=</span> <span class="st">"score"</span>,
                        within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,
                        data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">C</span> <span class="op">==</span> <span class="st">"C0"</span><span class="op">)</span>,
                        return <span class="op">=</span> <span class="st">"afex_aov"</span><span class="op">)</span>

<span class="va">aov_c1</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"sub_id"</span>,
                        dv <span class="op">=</span> <span class="st">"score"</span>,
                        within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,
                        data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">C</span> <span class="op">==</span> <span class="st">"C1"</span><span class="op">)</span>,
                        return <span class="op">=</span> <span class="st">"afex_aov"</span><span class="op">)</span>

<span class="va">aov_c2</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"sub_id"</span>,
                        dv <span class="op">=</span> <span class="st">"score"</span>,
                        within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,
                        data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">C</span> <span class="op">==</span> <span class="st">"C2"</span><span class="op">)</span>,
                        return <span class="op">=</span> <span class="st">"afex_aov"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">aov_control</span><span class="op">)</span><span class="op">[</span><span class="st">"A:B"</span>, <span class="st">"Pr(&gt;F)"</span><span class="op">]</span>,
  cond1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">aov_c1</span><span class="op">)</span><span class="op">[</span><span class="st">"A:B"</span>, <span class="st">"Pr(&gt;F)"</span><span class="op">]</span>,
  cond2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">aov_c2</span><span class="op">)</span><span class="op">[</span><span class="st">"A:B"</span>, <span class="st">"Pr(&gt;F)"</span><span class="op">]</span>
<span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<pre><code>## List of 3
##  $ control: num 0.878
##  $ cond1  : num 0.0836
##  $ cond2  : num 0.977</code></pre>
</div>
<div id="set-up-scienceverse-study" class="section level2">
<h2 class="hasAnchor">
<a href="#set-up-scienceverse-study" class="anchor"></a>Set up Scienceverse study</h2>
<p>Set up the study by adding simulated data (use the argument from <code><a href="https://rdrr.io/pkg/faux/man/sim_design.html">faux::sim_design()</a></code> above), the analyses above (make sure to add the library calls at the start of the analysis code or preface each function with the package name).</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/study.html">study</a></span><span class="op">(</span><span class="st">"Demo"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu"><a href="../reference/add_sim_data.html">add_sim_data</a></span><span class="op">(</span>data_id <span class="op">=</span> <span class="st">"dat"</span>,
    within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>, <span class="st">"A4"</span><span class="op">)</span>,
                  B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span><span class="op">)</span>,
    between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C0"</span>, <span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span><span class="op">)</span>,
    n <span class="op">=</span> <span class="fl">20</span>,
         <span class="co"># A1_B1, A1_B2, A2_B1 ... A4_B2</span>
    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="co"># C0</span>
           <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.2</span>,  <span class="fl">0</span>, <span class="fl">.4</span>,  <span class="fl">0</span>, <span class="fl">.6</span>,  <span class="fl">0</span>,  <span class="co"># C1</span>
           <span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">.2</span>,  <span class="fl">0</span>, <span class="fl">.4</span>,  <span class="fl">0</span>, <span class="fl">.6</span><span class="op">)</span>, <span class="co"># C2</span>
    sd <span class="op">=</span> <span class="fl">1</span>,
    r <span class="op">=</span> <span class="fl">0.5</span>,
    id <span class="op">=</span> <span class="st">"sub_id"</span>,
    dv <span class="op">=</span> <span class="st">"score"</span>,
    long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu"><a href="../reference/add_analysis.html">add_analysis</a></span><span class="op">(</span><span class="st">"ANOVA"</span>, code <span class="op">=</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span> <span class="co"># add for pipes</span>
    
    <span class="co"># run ANOVA</span>
    <span class="va">omnibus</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"sub_id"</span>,
                            dv <span class="op">=</span> <span class="st">"score"</span>,
                            between <span class="op">=</span> <span class="st">"C"</span>,
                            within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,
                            data <span class="op">=</span> <span class="va">dat</span>,
                            return <span class="op">=</span> <span class="st">"afex_aov"</span><span class="op">)</span>

    <span class="co"># get stats for 3-way interaction</span>
    <span class="va">ixn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">omnibus</span><span class="op">)</span><span class="op">[</span><span class="st">"C:A:B"</span>, <span class="op">]</span>

    <span class="co"># calculate group means</span>
    <span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">A</span>, <span class="va">B</span>, <span class="va">C</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="st">"grp"</span>, <span class="va">A</span>, <span class="va">B</span>, <span class="va">C</span><span class="op">)</span>
    
    <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">means</span><span class="op">$</span><span class="va">m</span>
    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">means</span><span class="op">$</span><span class="va">grp</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      p <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span>,
      F <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="cn">F</span>,
      means <span class="op">=</span> <span class="va">m</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></pre></div>
<p>Check the analysis works.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="../reference/study_analyse.html">study_analyse</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/get_result.html">get_result</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: C</code></pre>
<pre><code>## * p: 0.1393093
## * F: 1.6474692
## * means: 
##     * A1_B1_C0: 0.0649719
##     * A1_B1_C1: 0.2215913
##     * A1_B1_C2: 0.0500495
##     * A1_B2_C0: -0.0063149
##     * A1_B2_C1: 0.3299104
##     * A1_B2_C2: -0.2422676
##     * A2_B1_C0: -0.0694003
##     * A2_B1_C1: 0.2746144
##     * A2_B1_C2: -0.1725015
##     * A2_B2_C0: -0.1733002
##     * A2_B2_C1: 0.0783498
##     * A2_B2_C2: -0.2186378
##     * A3_B1_C0: -0.026929
##     * A3_B1_C1: 0.5473249
##     * A3_B1_C2: 0.1582065
##     * A3_B2_C0: -0.2743202
##     * A3_B2_C1: 0.0815687
##     * A3_B2_C2: 0.4101281
##     * A4_B1_C0: -0.1449238
##     * A4_B1_C1: 0.4450946
##     * A4_B1_C2: -0.1292933
##     * A4_B2_C0: 0.0637482
##     * A4_B2_C1: 0.31732
##     * A4_B2_C2: 0.6933566</code></pre>
<p>Add the extra analyses. They can go in the code of the main analysis and their results can be added to the returned list, or they can be added as separate analysis objects.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="va">s</span> <span class="op">&lt;-</span> <span class="va">s</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_analysis.html">add_analysis</a></span><span class="op">(</span><span class="st">"C0"</span>, code <span class="op">=</span> <span class="op">{</span>
    <span class="co"># run ANOVA</span>
    <span class="va">aov_c</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>
      id <span class="op">=</span> <span class="st">"sub_id"</span>,
      dv <span class="op">=</span> <span class="st">"score"</span>,
      within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">C</span> <span class="op">==</span> <span class="st">"C0"</span><span class="op">)</span>,
      return <span class="op">=</span> <span class="st">"afex_aov"</span><span class="op">)</span>

    <span class="co"># get stats for 2-way interaction</span>
    <span class="va">ixn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">aov_c</span><span class="op">)</span><span class="op">[</span><span class="st">"A:B"</span>, <span class="op">]</span>

    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      p <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span>,
      F <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="cn">F</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu"><a href="../reference/add_analysis.html">add_analysis</a></span><span class="op">(</span><span class="st">"C1"</span>, code <span class="op">=</span> <span class="op">{</span>
    <span class="co"># run ANOVA</span>
    <span class="va">aov_c</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>
      id <span class="op">=</span> <span class="st">"sub_id"</span>,
      dv <span class="op">=</span> <span class="st">"score"</span>,
      within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">C</span> <span class="op">==</span> <span class="st">"C1"</span><span class="op">)</span>,
      return <span class="op">=</span> <span class="st">"afex_aov"</span><span class="op">)</span>

    <span class="co"># get stats for 2-way interaction</span>
    <span class="va">ixn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">aov_c</span><span class="op">)</span><span class="op">[</span><span class="st">"A:B"</span>, <span class="op">]</span>

    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      p <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span>,
      F <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="cn">F</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu"><a href="../reference/add_analysis.html">add_analysis</a></span><span class="op">(</span><span class="st">"C2"</span>, code <span class="op">=</span> <span class="op">{</span>
    <span class="co"># run ANOVA</span>
    <span class="va">aov_c</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>
      id <span class="op">=</span> <span class="st">"sub_id"</span>,
      dv <span class="op">=</span> <span class="st">"score"</span>,
      within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">C</span> <span class="op">==</span> <span class="st">"C2"</span><span class="op">)</span>,
      return <span class="op">=</span> <span class="st">"afex_aov"</span><span class="op">)</span>

    <span class="co"># get stats for 2-way interaction</span>
    <span class="va">ixn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">aov_c</span><span class="op">)</span><span class="op">[</span><span class="st">"A:B"</span>, <span class="op">]</span>

    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      p <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span>,
      F <span class="op">=</span> <span class="va">ixn</span><span class="op">$</span><span class="cn">F</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></pre></div>
<p>Check the new analyses works.</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/study_analyse.html">study_analyse</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> </pre></div>
<pre><code>## Contrasts set to contr.sum for the following variables: C</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="../reference/get_result.html">get_result</a></span><span class="op">(</span><span class="va">s</span>, analysis_id <span class="op">=</span> <span class="st">"C0"</span><span class="op">)</span></pre></div>
<pre><code>## * p: 0.5718463
## * F: 0.6465138</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu"><a href="../reference/get_result.html">get_result</a></span><span class="op">(</span><span class="va">s</span>, analysis_id <span class="op">=</span> <span class="st">"C1"</span><span class="op">)</span></pre></div>
<pre><code>## * p: 0.4310396
## * F: 0.9096883</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="fu"><a href="../reference/get_result.html">get_result</a></span><span class="op">(</span><span class="va">s</span>, analysis_id <span class="op">=</span> <span class="st">"C2"</span><span class="op">)</span></pre></div>
<pre><code>## * p: 0.0108717
## * F: 4.2554061</code></pre>
<p>Add a hypothesis, specify criteria (here, just <code>p</code> &lt; 0.05), and add evaluation criteria. You can add criteria for both “corroboration” and “falsification”, but here we just have corroboration criteria.</p>
<p>(Ignore the statistically dodgy criterion of p &gt; 0.05 for the control condition. In practice, you’d do an equivalence test to show that the control condition has an effect smaller than the SESOI.)</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">s</span> <span class="op">&lt;-</span> <span class="va">s</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_hypothesis.html">add_hypothesis</a></span><span class="op">(</span><span class="st">"IXN"</span>, <span class="st">"There will be a significant 3-way interaction among factors A, B and C"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># C:A:B interaction significant</span>
  <span class="fu"><a href="../reference/add_criterion.html">add_criterion</a></span><span class="op">(</span><span class="st">"sig_ixn"</span>, 
                result <span class="op">=</span> <span class="st">"p"</span>, 
                operator <span class="op">=</span> <span class="st">"&lt;"</span>, 
                comparator <span class="op">=</span> <span class="fl">0.05</span>,
                analysis_id <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span> <span class="op">%&gt;%</span>

  <span class="co"># add criteria to show the pattern is as expected</span>
  
  <span class="co"># A1 &lt; A2 &lt; A3 &lt; A4 from B1 in C1</span>
  <span class="fu"><a href="../reference/add_criterion.html">add_criterion</a></span><span class="op">(</span><span class="st">"c1_1"</span>,
                result <span class="op">=</span> <span class="st">"mean$A1_B1_C1"</span>, 
                operator <span class="op">=</span> <span class="st">"&lt;"</span>, 
                comparator <span class="op">=</span> <span class="st">"mean$A2_B1_C1"</span>,
                analysis_id <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu"><a href="../reference/add_criterion.html">add_criterion</a></span><span class="op">(</span><span class="st">"c1_2"</span>,
                result <span class="op">=</span> <span class="st">"mean$A2_B1_C1"</span>, 
                operator <span class="op">=</span> <span class="st">"&lt;"</span>, 
                comparator <span class="op">=</span> <span class="st">"mean$A3_B1_C1"</span>,
                analysis_id <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu"><a href="../reference/add_criterion.html">add_criterion</a></span><span class="op">(</span><span class="st">"c1_3"</span>,
                result <span class="op">=</span> <span class="st">"mean$A3_B1_C1"</span>, 
                operator <span class="op">=</span> <span class="st">"&lt;"</span>, 
                comparator <span class="op">=</span> <span class="st">"mean$A4_B1_C1"</span>,
                analysis_id <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="co"># A1 &lt; A2 &lt; A3 &lt; A4 from B2 in C2</span>
  <span class="fu"><a href="../reference/add_criterion.html">add_criterion</a></span><span class="op">(</span><span class="st">"c2_1"</span>,
                result <span class="op">=</span> <span class="st">"mean$A1_B2_C2"</span>, 
                operator <span class="op">=</span> <span class="st">"&lt;"</span>, 
                comparator <span class="op">=</span> <span class="st">"mean$A2_B2_C2"</span>,
                analysis_id <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu"><a href="../reference/add_criterion.html">add_criterion</a></span><span class="op">(</span><span class="st">"c2_2"</span>,
                result <span class="op">=</span> <span class="st">"mean$A2_B2_C2"</span>, 
                operator <span class="op">=</span> <span class="st">"&lt;"</span>, 
                comparator <span class="op">=</span> <span class="st">"mean$A3_B2_C2"</span>,
                analysis_id <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu"><a href="../reference/add_criterion.html">add_criterion</a></span><span class="op">(</span><span class="st">"c2_3"</span>,
                result <span class="op">=</span> <span class="st">"mean$A3_B2_C2"</span>, 
                operator <span class="op">=</span> <span class="st">"&lt;"</span>, 
                comparator <span class="op">=</span> <span class="st">"mean$A4_B2_C2"</span>,
                analysis_id <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="co"># all criteria must be true to corroborate</span>
  <span class="fu"><a href="../reference/add_eval.html">add_eval</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"corroboration"</span>,
          evaluation <span class="op">=</span> <span class="st">"sig_ixn &amp; c1_1 &amp; c1_2 &amp; c1_3 &amp; c2_1 &amp; c2_2 &amp; c2_3"</span><span class="op">)</span></pre></div>
</div>
<div id="run-power-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#run-power-simulation" class="anchor"></a>Run power simulation</h2>
<p>Running <code><a href="../reference/study_power.html">study_power()</a></code> returns a study object that has <code>rep</code> values stored for the analysis criteria and evaluations. <code><a href="../reference/get_power.html">get_power()</a></code> returns the evaluation criteria for each hypothesis and, optionally, the criteria values.</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/study_power.html">study_power</a></span><span class="op">(</span><span class="va">s</span>, rep <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></pre></div>
<pre><code>## Warning in study_power(s, rep = 100): Hypothesis IXN has no evaluation criteria
## for falsification</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="va">power</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_power.html">get_power</a></span><span class="op">(</span><span class="va">s</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">power</span><span class="op">$</span><span class="va">power</span><span class="op">)</span></pre></div>
<pre><code>## List of 1
##  $ IXN:List of 3
##   ..$ corroboration: num 0.46
##   ..$ falsification: num 0
##   ..$ inconclusive : num 0.54</code></pre>
<p>Plot the resulting values.</p>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  ixn <span class="op">=</span> <span class="va">power</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">ANOVA</span><span class="op">$</span><span class="va">p</span>,
  c0 <span class="op">=</span> <span class="va">power</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">C0</span><span class="op">$</span><span class="va">p</span>,
  c1 <span class="op">=</span> <span class="va">power</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">C1</span><span class="op">$</span><span class="va">p</span>,
  c2 <span class="op">=</span> <span class="va">power</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">C2</span><span class="op">$</span><span class="va">p</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="st">"analysis"</span>, <span class="st">"p"</span>, <span class="va">ixn</span><span class="op">:</span><span class="va">c2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">p</span>, fill <span class="op">=</span> <span class="va">analysis</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span>, color <span class="op">=</span> <span class="st">"black"</span>, 
                 boundary <span class="op">=</span> <span class="fl">0</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">analysis</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"p-values"</span><span class="op">)</span></pre></div>
<p><img src="power_files/figure-html/unnamed-chunk-13-1.png" width="100%"></p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">power</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">ANOVA</span><span class="op">$</span><span class="va">means</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="va">A1_B1_C0</span><span class="op">:</span><span class="va">A4_B2_C2</span>,
    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,
    names_sep <span class="op">=</span> <span class="st">"_"</span>,
    values_to <span class="op">=</span> <span class="st">"mean"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">A</span>, y <span class="op">=</span> <span class="va">mean</span>, colour <span class="op">=</span> <span class="va">B</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">C</span><span class="op">~</span><span class="va">.</span><span class="op">)</span></pre></div>
<p><img src="power_files/figure-html/unnamed-chunk-14-1.png" width="100%"></p>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">power</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">ANOVA</span><span class="op">$</span><span class="va">means</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="va">A1_B1_C0</span><span class="op">:</span><span class="va">A4_B2_C2</span>,
    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,
    names_sep <span class="op">=</span> <span class="st">"_"</span>,
    values_to <span class="op">=</span> <span class="st">"mean"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>
    names_from <span class="op">=</span> <span class="va">B</span>,
    values_from <span class="op">=</span> <span class="va">`mean`</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>B_diff <span class="op">=</span> <span class="va">B2</span> <span class="op">-</span> <span class="va">B1</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">A</span>, y <span class="op">=</span> <span class="va">B_diff</span>, colour <span class="op">=</span> <span class="va">C</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="power_files/figure-html/unnamed-chunk-15-1.png" width="100%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lisa DeBruine, Daniel Lakens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
